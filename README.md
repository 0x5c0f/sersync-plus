# Sersync Plus

> ğŸ¤– **ååŒå¼€å‘è¯´æ˜**  
> æœ¬é¡¹ç›®ç”± [0x5c0f](https://github.com/0x5c0f) ä¸ Kiro AI åœ¨ [Kiro ç¼–è¾‘å™¨](https://kiro.dev/) ä¸­ååŒå®Œæˆå¼€å‘ã€‚  
> Kiro AI è´Ÿè´£ä¸»è¦çš„æ¶æ„è®¾è®¡ã€ä»£ç å®ç°å’Œæ–‡æ¡£ç¼–å†™ï¼Œ0x5c0f è´Ÿè´£éœ€æ±‚åˆ†æã€æµ‹è¯•éªŒè¯å’Œé¡¹ç›®ç®¡ç†ã€‚

[![Python Version](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Code Style](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
[![GitHub Repository](https://img.shields.io/badge/GitHub-sersync--plus-blue.svg)](https://github.com/0x5c0f/sersync-plus)

**Sersync Plus** æ˜¯å¯¹åŸç‰ˆ sersync çš„å¢å¼ºé‡å†™ç‰ˆæœ¬ï¼Œä½¿ç”¨ Python å¼€å‘ï¼Œå®Œå…¨å…¼å®¹åŸç‰ˆé…ç½®æ–‡ä»¶ï¼Œå¹¶æä¾›äº†ä¸°å¯Œçš„æ‰©å±•åŠŸèƒ½ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ **åŸºç¡€åŒæ­¥åŠŸèƒ½**
- âœ… **å®æ—¶æ–‡ä»¶ç›‘æ§** - åŸºäº inotifyï¼ˆLinuxï¼‰/ watchdogï¼ˆè·¨å¹³å°ï¼‰
- âœ… **Rsync é›†æˆ** - é«˜æ•ˆå¢é‡ä¼ è¾“ï¼Œæ”¯æŒ SSH å’Œ Rsync åè®®
- âœ… **äº‹ä»¶æ™ºèƒ½åˆå¹¶** - æ—¶é—´çª—å£åˆå¹¶ï¼Œå‡å°‘åŒæ­¥æ¬¡æ•°
- âœ… **å¤šç›®æ ‡å¹¶å‘åŒæ­¥** - åŒæ—¶åŒæ­¥åˆ°å¤šä¸ªè¿œç¨‹æœåŠ¡å™¨
- âœ… **æ–‡ä»¶è¿‡æ»¤ç³»ç»Ÿ** - æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ + è‡ªåŠ¨ä¸´æ—¶æ–‡ä»¶è¿‡æ»¤
- âœ… **å¤±è´¥é‡è¯•æœºåˆ¶** - è‡ªåŠ¨é‡è¯•å¤±è´¥çš„åŒæ­¥ä»»åŠ¡
- âœ… **å®šæœŸå…¨é‡åŒæ­¥** - å¯é…ç½®çš„ crontab å®šæ—¶åŒæ­¥

### ğŸ”„ **åŒå‘åŒæ­¥** â­ æ–°å¢
- âœ… **å†²çªæ™ºèƒ½æ£€æµ‹** - åŸºäºå…ƒæ•°æ®çš„å†²çªæ£€æµ‹
- âœ… **å¤šç§è§£å†³ç­–ç•¥** - 8 ç§å†²çªè§£å†³ç­–ç•¥å¯é€‰
- âœ… **å®‰å…¨å…ƒæ•°æ®å­˜å‚¨** - å…ƒæ•°æ®æ–‡ä»¶å­˜å‚¨åœ¨ç›‘æ§ç›®å½•å¤–
- âœ… **è‡ªåŠ¨å¤‡ä»½** - å†²çªæ–‡ä»¶è‡ªåŠ¨å¤‡ä»½
- âœ… **èŠ‚ç‚¹æ ‡è¯†** - æ”¯æŒå¤šèŠ‚ç‚¹åŒå‘åŒæ­¥

### ğŸ“¢ **é€šçŸ¥ç³»ç»Ÿ**
- âœ… **Apprise é›†æˆ** - æ”¯æŒ 100+ é€šçŸ¥æœåŠ¡
- âœ… **çµæ´»è§„åˆ™å¼•æ“** - ç«‹å³é€šçŸ¥ã€æ‰¹é‡é€šçŸ¥ã€å®šæ—¶é€šçŸ¥
- âœ… **è‡ªå®šä¹‰æ¨¡æ¿** - æ¶ˆæ¯æ¨¡æ¿æ”¯æŒå˜é‡æ›¿æ¢
- âœ… **å¸¸ç”¨æœåŠ¡** - ä¼ä¸šå¾®ä¿¡ã€é’‰é’‰ã€Slackã€é‚®ä»¶ç­‰

### ğŸ–¥ï¸ **Web ç®¡ç†ç•Œé¢**
- âœ… **å®æ—¶ç›‘æ§** - WebSocket å®æ—¶æ¨é€ç³»ç»ŸçŠ¶æ€
- âœ… **åŒæ­¥å†å²** - å®Œæ•´çš„åŒæ­¥å†å²è®°å½•å’Œç»Ÿè®¡
- âœ… **REST API** - å®Œæ•´çš„ RESTful API æ¥å£
- âœ… **æ•°æ®æŒä¹…åŒ–** - SQLite æ•°æ®åº“å­˜å‚¨æ—¥å¿—å’ŒæŒ‡æ ‡
- âœ… **ç°ä»£åŒ–ä»ªè¡¨ç›˜** - å“åº”å¼ HTML ä»ªè¡¨ç›˜
- âœ… **è®¤è¯ç³»ç»Ÿ** - Basic Auth å®‰å…¨è®¤è¯

---

## ğŸ“¦ å®‰è£…

### å‰ç½®è¦æ±‚
- Python 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- rsyncï¼ˆç”¨äºæ–‡ä»¶åŒæ­¥ï¼‰
- inotify-toolsï¼ˆLinuxï¼Œå¯é€‰ï¼‰

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Poetryï¼ˆæ¨èå¼€å‘ï¼‰
```bash
git clone https://github.com/0x5c0f/sersync-plus.git
cd sersync-plus
poetry install
poetry run sersync-plus --help
```

### æ–¹å¼äºŒï¼šä½¿ç”¨ pip
```bash
pip install sersync-plus
sersync-plus --help
```

### æ–¹å¼ä¸‰ï¼šäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæ¨èç”Ÿäº§ï¼‰
```bash
# ä¸‹è½½é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶
wget https://github.com/0x5c0f/sersync-plus/releases/latest/download/sersync-plus
chmod +x sersync-plus
./sersync-plus --help

# æˆ–è€…è‡ªè¡Œæ„å»º
git clone https://github.com/0x5c0f/sersync-plus.git
cd sersync-plus
make binary
./dist/sersync-plus --help
```

### ç³»ç»Ÿä¾èµ–å®‰è£…
```bash
# Debian/Ubuntu
sudo apt install rsync inotify-tools

# CentOS/RHEL
sudo yum install rsync

# macOS
brew install rsync
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬åŒæ­¥
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®æ–‡ä»¶
sersync-plus -o confxml.xml

# å¯åŠ¨å‰æ‰§è¡Œå…¨é‡åŒæ­¥
sersync-plus -r -o confxml.xml

# åå°è¿è¡Œ
sersync-plus -d -o confxml.xml
```

### 2. Web ç®¡ç†ç•Œé¢
```bash
# å¯åŠ¨ Web ç•Œé¢
sersync-plus --web --web-port 8000 -o confxml.xml

# è®¿é—®ç®¡ç†ç•Œé¢
open http://localhost:8000
# é»˜è®¤ç”¨æˆ·å: admin, å¯†ç : admin123
```

### 3. åŒå‘åŒæ­¥
```bash
# ä½¿ç”¨åŒå‘åŒæ­¥é…ç½®
sersync-plus -o examples/confxml_bidirectional.xml
```

---

## ğŸ“‹ é…ç½®æ–‡ä»¶

Sersync Plus å®Œå…¨å…¼å®¹åŸç‰ˆ sersync çš„ XML é…ç½®æ–‡ä»¶æ ¼å¼ï¼ŒåŒæ—¶æ‰©å±•äº†æ–°åŠŸèƒ½ã€‚

### åŸºæœ¬é…ç½®ç¤ºä¾‹
```xml
<?xml version="1.0" encoding="UTF-8"?>
<head version="2.5">
    <host hostip="localhost" port="8008"/>
    <debug start="false"/>
    
    <sersync>
        <localpath watch="/data/sync">
            <remote ip="192.168.1.100" name="backup"/>
        </localpath>
        
        <rsync>
            <commonParams params="-artuz"/>
            <auth start="true" users="rsync_user" passwordfile="/etc/rsync.pass"/>
        </rsync>
        
        <failLog path="/tmp/rsync_fail_log.sh" timeToExecute="60"/>
    </sersync>
    
    <!-- Web ç®¡ç†ç•Œé¢ -->
    <web enabled="true" port="8000"/>
    
    <!-- æ•°æ®åº“é…ç½® -->
    <database enabled="true" path="/var/sersync/sersync.db"/>
</head>
```

æ›´å¤šé…ç½®ç¤ºä¾‹è¯·æŸ¥çœ‹ `examples/` ç›®å½•ã€‚

---

## ğŸ”§ å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `-o, --config` | é…ç½®æ–‡ä»¶è·¯å¾„ |
| `-r, --initial-sync` | å¯åŠ¨å‰æ‰§è¡Œå…¨é‡åŒæ­¥ |
| `-d, --daemon` | åå°å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ |
| `-n, --threads` | çº¿ç¨‹æ± å¤§å° |
| `--web` | å¯ç”¨ Web ç®¡ç†ç•Œé¢ |
| `--web-port` | Web ç•Œé¢ç«¯å£ |
| `--log-level` | æ—¥å¿—çº§åˆ« |
| `--db-path` | æ•°æ®åº“æ–‡ä»¶è·¯å¾„ |
| `--log-file` | æ—¥å¿—æ–‡ä»¶è·¯å¾„ |

---

## ğŸŒŸ æ–°å¢åŠŸèƒ½è¯¦è§£

### åŒæ­¥å†å²è®°å½•
- **æ°¸ä¹…å­˜å‚¨**: æ‰€æœ‰åŒæ­¥æ“ä½œè®°å½•åˆ°æ•°æ®åº“
- **åˆ†é¡µæŸ¥è¯¢**: æ”¯æŒå¤§æ•°æ®é‡çš„é«˜æ•ˆåˆ†é¡µ
- **ç»Ÿè®¡åˆ†æ**: æˆåŠŸç‡ã€è€—æ—¶ã€çƒ­é—¨æ–‡ä»¶ç­‰ç»Ÿè®¡
- **æ€§èƒ½ä¼˜åŒ–**: ç´¢å¼•ä¼˜åŒ–ã€ç¼“å­˜æœºåˆ¶ã€è™šæ‹Ÿæ»šåŠ¨

### åŒå‘åŒæ­¥
- **å…ƒæ•°æ®ç®¡ç†**: å®‰å…¨çš„å…ƒæ•°æ®å­˜å‚¨ï¼Œé¿å…åŒæ­¥å†²çª
- **å†²çªæ£€æµ‹**: æ™ºèƒ½æ£€æµ‹æ–‡ä»¶å†²çª
- **è§£å†³ç­–ç•¥**: keep_newerã€keep_olderã€backup_both ç­‰å¤šç§ç­–ç•¥
- **èŠ‚ç‚¹æ ‡è¯†**: æ”¯æŒå¤šèŠ‚ç‚¹ç¯å¢ƒçš„åŒå‘åŒæ­¥

### é€šçŸ¥ç³»ç»Ÿ
- **Apprise é›†æˆ**: æ”¯æŒ 100+ é€šçŸ¥æœåŠ¡
- **è§„åˆ™å¼•æ“**: çµæ´»çš„é€šçŸ¥è§„åˆ™é…ç½®
- **æ¨¡æ¿ç³»ç»Ÿ**: è‡ªå®šä¹‰æ¶ˆæ¯æ¨¡æ¿
- **æ‰¹é‡é€šçŸ¥**: é¿å…é€šçŸ¥è½°ç‚¸çš„æ‰¹é‡æœºåˆ¶

---

## ï¿½ å¼€å‘ä¸æ„å»º

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/0x5c0f/sersync-plus.git
cd sersync-plus

# å®‰è£…ä¾èµ–
make install
# æˆ–è€…
poetry install --with dev

# è¿è¡Œæµ‹è¯•
make test
# æˆ–è€…
poetry run pytest
```

### æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶
```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨ Makeï¼ˆæ¨èï¼‰
make binary

# æ–¹å¼äºŒï¼šä½¿ç”¨æ„å»ºè„šæœ¬
python scripts/build.py

# æ–¹å¼ä¸‰ï¼šå¿«é€Ÿæ„å»º
./scripts/build.sh

# æ–¹å¼å››ï¼šæ‰‹åŠ¨æ„å»º
poetry run pyinstaller build.spec
```

### å¯ç”¨çš„ Make å‘½ä»¤
```bash
make help          # æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
make install       # å®‰è£…ä¾èµ–
make test          # è¿è¡Œæµ‹è¯•
make build         # æ„å»º Python åŒ…
make binary        # æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶
make binary-fast   # å¿«é€Ÿæ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶
make clean         # æ¸…ç†æ„å»ºæ–‡ä»¶
make lint          # ä»£ç è´¨é‡æ£€æŸ¥
make format        # æ ¼å¼åŒ–ä»£ç 
make ci            # å®Œæ•´ CI æµç¨‹
make release       # å‘å¸ƒå‡†å¤‡
```

### æ„å»ºè¾“å‡º
- **Python åŒ…**: `dist/*.whl`
- **äºŒè¿›åˆ¶æ–‡ä»¶**: `dist/sersync-plus`ï¼ˆçº¦ 50-80MBï¼‰
- **æ”¯æŒå¹³å°**: Linux, macOS, Windows

---

## ğŸ› ï¸ å¼€å‘

### ç¯å¢ƒè®¾ç½®
```bash
git clone https://github.com/0x5c0f/sersync-plus.git
cd sersync-plus
poetry install --with dev
```

### è¿è¡Œæµ‹è¯•
```bash
poetry run pytest
poetry run pytest --cov=sersync
```

### ä»£ç è´¨é‡æ£€æŸ¥
```bash
poetry run ruff check .
poetry run mypy sersync/
```

---

## ğŸ“š æ–‡æ¡£

- [é…ç½®æŒ‡å—](docs/configuration.md)
- [API æ–‡æ¡£](docs/api.md)
- [åŒå‘åŒæ­¥æŒ‡å—](docs/bidirectional-sync.md)
- [é€šçŸ¥é…ç½®](docs/notifications.md)
- [æ•…éšœæ’æŸ¥](docs/troubleshooting.md)

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

### å¼€å‘æµç¨‹
1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

## ğŸ™ è‡´è°¢

- åŸç‰ˆ [sersync](https://github.com/wsgzao/sersync) é¡¹ç›®
- [Apprise](https://github.com/caronc/apprise) - é€šçŸ¥ç³»ç»Ÿ
- [FastAPI](https://fastapi.tiangolo.com/) - Web æ¡†æ¶

---

## ğŸ“ æ”¯æŒ

- ğŸ› [æŠ¥å‘Šé—®é¢˜](https://github.com/0x5c0f/sersync-plus/issues)
- ğŸ’¬ [è®¨è®ºåŒº](https://github.com/0x5c0f/sersync-plus/discussions)
- ğŸ“§ é‚®ä»¶: i@0x5c0f.cc

---

**Sersync Plus** - è®©æ–‡ä»¶åŒæ­¥æ›´ç®€å•ã€æ›´å¼ºå¤§ï¼
- rsyncï¼ˆç”¨äºæ–‡ä»¶åŒæ­¥ï¼‰
- unisonï¼ˆå¯é€‰ï¼Œç”¨äºåŒå‘åŒæ­¥ï¼‰

### ä½¿ç”¨ Poetryï¼ˆæ¨èï¼‰

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yourusername/sersync-python.git
cd sersync-python

# å®‰è£…ä¾èµ–
poetry install

# å®‰è£…å®Œæ•´åŠŸèƒ½ï¼ˆåŒ…æ‹¬é€šçŸ¥ç³»ç»Ÿï¼‰
poetry install -E notifications

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
poetry shell
```

### ä½¿ç”¨ pip

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yourusername/sersync-python.git
cd sersync-python

# å®‰è£…
pip install -e .

# å®‰è£…å®Œæ•´åŠŸèƒ½
pip install -e .[notifications]
```

### å®‰è£…ç³»ç»Ÿä¾èµ–

```bash
# Debian/Ubuntu
sudo apt install rsync unison inotify-tools

# CentOS/RHEL
sudo yum install rsync unison

# macOS
brew install rsync unison
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬å•å‘åŒæ­¥

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆå‚è€ƒ examples/confxml.xmlï¼‰
cp examples/confxml.xml /etc/sersync.xml

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®ç›‘æ§è·¯å¾„å’Œè¿œç¨‹ç›®æ ‡
vim /etc/sersync.xml

# å‰å°è¿è¡Œï¼Œå¸¦åˆå§‹å…¨é‡åŒæ­¥
sersync -r -o /etc/sersync.xml

# åå°è¿è¡Œ
sersync -d -o /etc/sersync.xml
```

### 2. å¯ç”¨ Web ç®¡ç†ç•Œé¢

```bash
# å¯åŠ¨ Web ç•Œé¢ï¼ˆç«¯å£ 8000ï¼‰
sersync --web --web-port 8000 -o /etc/sersync.xml

# è®¿é—® Web ç•Œé¢
# http://localhost:8000
# é»˜è®¤ç”¨æˆ·åï¼šadmin
# é»˜è®¤å¯†ç ï¼šadmin123
```

### 3. åŒå‘åŒæ­¥

```bash
# æ–¹å¼ 1ï¼šå‘½ä»¤è¡Œå‚æ•°
sersync --bidirectional \
  --bidir-host 192.168.1.100 \
  --bidir-root /data/remote \
  --conflict-strategy keep_newer \
  -o /etc/sersync.xml

# æ–¹å¼ 2ï¼šé…ç½®æ–‡ä»¶ï¼ˆå‚è€ƒ examples/confxml_bidirectional.xmlï¼‰
sersync -o /etc/sersync/confxml_bidirectional.xml
```

### 4. å¯ç”¨é€šçŸ¥ç³»ç»Ÿ

```bash
# åˆ›å»º Apprise é…ç½®æ–‡ä»¶
cp examples/apprise_full.yml /etc/sersync/apprise.yml

# ç¼–è¾‘é…ç½®ï¼Œæ·»åŠ é€šçŸ¥æœåŠ¡
vim /etc/sersync/apprise.yml

# åœ¨ confxml.xml ä¸­å¯ç”¨é€šçŸ¥
# å‚è€ƒ examples/confxml_with_notification.xml

# å¯åŠ¨
sersync -o /etc/sersync.xml
```

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### å‘½ä»¤è¡Œé€‰é¡¹

```bash
Usage: sersync [OPTIONS]

Options:
  -o, --config PATH              é…ç½®æ–‡ä»¶è·¯å¾„ [é»˜è®¤: ./confxml.xml]
  -r, --initial-sync             å¯åŠ¨å‰æ‰§è¡Œä¸€æ¬¡å…¨é‡åŒæ­¥
  -d, --daemon                   åå°å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼
  -n, --threads INTEGER          çº¿ç¨‹æ± å¤§å° [é»˜è®¤: 10]
  -m, --plugin TEXT              ä»…è¿è¡ŒæŒ‡å®šæ’ä»¶ï¼ˆä¸åŒæ­¥ï¼‰
  --web                          å¯ç”¨ Web ç®¡ç†ç•Œé¢
  --web-port INTEGER             Web ç•Œé¢ç«¯å£ [é»˜è®¤: 8000]
  --log-level [DEBUG|INFO|WARNING|ERROR]
                                 æ—¥å¿—çº§åˆ« [é»˜è®¤: INFO]
  --log-format [text|json]       æ—¥å¿—æ ¼å¼ [é»˜è®¤: text]
  --bidirectional                å¯ç”¨åŒå‘åŒæ­¥æ¨¡å¼
  --bidir-host TEXT              åŒå‘åŒæ­¥è¿œç¨‹ä¸»æœº
  --bidir-root TEXT              åŒå‘åŒæ­¥è¿œç¨‹æ ¹ç›®å½•
  --conflict-strategy [keep_newer|keep_older|keep_local|keep_remote|backup_both|manual|skip]
                                 å†²çªè§£å†³ç­–ç•¥ [é»˜è®¤: keep_newer]
  --version                      æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯
  --help                         æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
```

### ä½¿ç”¨ç¤ºä¾‹

```bash
# å‰å°è¿è¡Œï¼Œåˆå§‹å…¨é‡åŒæ­¥
sersync -r -o /etc/sersync.xml

# åå°è¿è¡Œï¼Œ20 çº¿ç¨‹ï¼Œå¯ç”¨ Web ç•Œé¢
sersync -d -n 20 --web --web-port 8000

# åŒå‘åŒæ­¥ + Web ç•Œé¢
sersync --bidirectional --bidir-host 192.168.1.100 \
  --bidir-root /data/remote --web

# è°ƒè¯•æ¨¡å¼
sersync --log-level DEBUG -o /etc/sersync.xml

# ä»…è¿è¡Œæ’ä»¶
sersync -m refreshCDN -o /etc/sersync.xml
```

---

## âš™ï¸ é…ç½®æ–‡ä»¶

### åŸºæœ¬é…ç½®ç¤ºä¾‹

```xml
<?xml version="1.0" encoding="UTF-8"?>
<head version="2.5">
    <!-- æœ¬åœ°ç›‘æ§è·¯å¾„ -->
    <localpath watch="/data/sync">
        <!-- è¿œç¨‹ç›®æ ‡æœåŠ¡å™¨ -->
        <remote ip="192.168.1.100" name="backup"/>
        <remote ip="192.168.1.101" name="backup"/>
    </localpath>

    <!-- Rsync é…ç½® -->
    <rsync>
        <commonParams params="-artuz"/>
        <auth start="false"/>
        <ssh start="true" user="root" port="22"/>
    </rsync>

    <!-- æ–‡ä»¶è¿‡æ»¤ -->
    <filter start="true">
        <exclude expression="(.*)\.tmp"/>
        <exclude expression="(.*)\.swp"/>
    </filter>

    <!-- Inotify äº‹ä»¶é…ç½® -->
    <inotify>
        <delete start="true"/>
        <closeWrite start="true"/>
        <moveFrom start="true"/>
        <moveTo start="true"/>
    </inotify>

    <!-- å®šæ—¶å…¨é‡åŒæ­¥ï¼ˆæ¯ 600 åˆ†é’Ÿï¼‰ -->
    <crontab start="true" schedule="600"/>

    <!-- å¤±è´¥é‡è¯• -->
    <failLog path="/var/sersync/rsync_fail.sh" timeToExecute="60"/>
</head>
```

å®Œæ•´é…ç½®ç¤ºä¾‹è¯·å‚è€ƒï¼š
- `examples/confxml.xml` - åŸºæœ¬é…ç½®
- `examples/confxml_bidirectional.xml` - åŒå‘åŒæ­¥é…ç½®
- `examples/confxml_with_notification.xml` - é€šçŸ¥ç³»ç»Ÿé…ç½®
- `examples/confxml_with_web.xml` - Web ç•Œé¢é…ç½®

---

## ğŸ”„ åŒå‘åŒæ­¥è¯¦è§£

### å†²çªç±»å‹

Sersync å¯ä»¥è‡ªåŠ¨æ£€æµ‹ä»¥ä¸‹ 6 ç§å†²çªç±»å‹ï¼š

1. **BOTH_MODIFIED** - åŒæ–¹éƒ½ä¿®æ”¹äº†åŒä¸€æ–‡ä»¶
2. **LOCAL_DELETED_REMOTE_MODIFIED** - æœ¬åœ°åˆ é™¤ï¼Œè¿œç¨‹ä¿®æ”¹
3. **REMOTE_DELETED_LOCAL_MODIFIED** - è¿œç¨‹åˆ é™¤ï¼Œæœ¬åœ°ä¿®æ”¹
4. **BOTH_CREATED** - åŒæ–¹åŒæ—¶åˆ›å»ºäº†ä¸åŒå†…å®¹çš„æ–‡ä»¶
5. **MOVE_CONFLICT** - æ–‡ä»¶ç§»åŠ¨å†²çª
6. **NO_CONFLICT** - æ— å†²çª

### å†²çªè§£å†³ç­–ç•¥

æä¾› 8 ç§å†²çªè§£å†³ç­–ç•¥ï¼š

| ç­–ç•¥ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| `keep_newer` | ä¿ç•™ä¿®æ”¹æ—¶é—´è¾ƒæ–°çš„æ–‡ä»¶ | **æ¨èé»˜è®¤ç­–ç•¥** |
| `keep_older` | ä¿ç•™ä¿®æ”¹æ—¶é—´è¾ƒæ—§çš„æ–‡ä»¶ | æ¢å¤è¯¯æ“ä½œ |
| `keep_larger` | ä¿ç•™æ–‡ä»¶å¤§å°è¾ƒå¤§çš„æ–‡ä»¶ | æ—¥å¿—æ–‡ä»¶ã€æ•°æ®ç§¯ç´¯ |
| `keep_local` | æ€»æ˜¯ä¿ç•™æœ¬åœ°ç‰ˆæœ¬ | æœ¬åœ°æ˜¯æƒå¨æ•°æ®æº |
| `keep_remote` | æ€»æ˜¯ä¿ç•™è¿œç¨‹ç‰ˆæœ¬ | è¿œç¨‹æ˜¯æƒå¨æ•°æ®æº |
| `backup_both` | å¤‡ä»½åŒæ–¹ï¼Œä¿ç•™ä¸¤ä¸ªç‰ˆæœ¬ | é‡è¦æ–‡ä»¶ï¼Œéœ€äººå·¥å®¡æŸ¥ |
| `manual` | éœ€è¦æ‰‹åŠ¨ä»‹å…¥ | å…³é”®æ–‡ä»¶ï¼Œéœ€äººå·¥å†³ç­– |
| `skip` | è·³è¿‡åŒæ­¥ | ä¸´æ—¶å¿½ç•¥æŸäº›å†²çª |

### ä½¿ç”¨ç¤ºä¾‹

```bash
# ä¿ç•™è¾ƒæ–°çš„æ–‡ä»¶ï¼ˆæ¨èï¼‰
sersync --bidirectional --bidir-host 192.168.1.100 --bidir-root /data/remote --conflict-strategy keep_newer

# æ€»æ˜¯ä¿ç•™æœ¬åœ°æ–‡ä»¶
sersync --bidirectional --bidir-host 192.168.1.100 --bidir-root /data/remote --conflict-strategy keep_local

# å¤‡ä»½åŒæ–¹ï¼ˆé‡è¦æ–‡ä»¶ï¼‰
sersync --bidirectional --bidir-host 192.168.1.100 --bidir-root /data/remote --conflict-strategy backup_both
```

### å¤‡ä»½æ–‡ä»¶ä½ç½®

å†²çªæ–‡ä»¶ä¼šè‡ªåŠ¨å¤‡ä»½åˆ°ï¼š`/var/sersync/bidirectional/conflicts/`

å¤‡ä»½æ–‡ä»¶å‘½åæ ¼å¼ï¼š
```
åŸæ–‡ä»¶å_æ¥æº_æ—¶é—´æˆ³.æ‰©å±•å

ä¾‹å¦‚ï¼š
config_local_20240120_143022.json
config_remote_20240120_143022.json
```

---

## ğŸ–¥ï¸ Web ç®¡ç†ç•Œé¢

### åŠŸèƒ½ç‰¹æ€§

- **å®æ—¶ç›‘æ§ä»ªè¡¨ç›˜** - CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡
- **åŒæ­¥ç»Ÿè®¡** - æ€»äº‹ä»¶æ•°ã€å·²åŒæ­¥æ–‡ä»¶ã€é˜Ÿåˆ—å¤§å°ã€æˆåŠŸç‡
- **å®æ—¶äº‹ä»¶æµ** - æ˜¾ç¤ºæœ€è¿‘ 50 æ¡æ–‡ä»¶å˜æ›´äº‹ä»¶
- **WebSocket æ¨é€** - æœåŠ¡å™¨ä¸»åŠ¨æ¨é€çŠ¶æ€æ›´æ–°ï¼ˆæ¯ 2 ç§’ï¼‰
- **æ—¥å¿—æŸ¥è¯¢** - æœç´¢å’ŒæŸ¥çœ‹åº”ç”¨æ—¥å¿—
- **æ§åˆ¶æ¥å£** - å¯åŠ¨/åœæ­¢å¼•æ“ã€è§¦å‘å…¨é‡åŒæ­¥

### API ç«¯ç‚¹

```
GET  /                       # Web ä»ªè¡¨ç›˜
GET  /health                 # å¥åº·æ£€æŸ¥
GET  /api/status/current     # ç³»ç»ŸçŠ¶æ€
GET  /api/status/metrics     # æ€§èƒ½æŒ‡æ ‡
GET  /api/config/summary     # é…ç½®æ‘˜è¦
GET  /api/logs/recent        # æœ€è¿‘æ—¥å¿—
GET  /api/logs/search        # æœç´¢æ—¥å¿—
GET  /api/logs/stats         # æ—¥å¿—ç»Ÿè®¡
POST /api/control/start      # å¯åŠ¨å¼•æ“ï¼ˆéœ€è®¤è¯ï¼‰
POST /api/control/stop       # åœæ­¢å¼•æ“ï¼ˆéœ€è®¤è¯ï¼‰
POST /api/control/full-sync  # å…¨é‡åŒæ­¥ï¼ˆéœ€è®¤è¯ï¼‰
WS   /ws                     # WebSocket è¿æ¥
```

### ç‹¬ç«‹è¿è¡Œ Web æœåŠ¡

```bash
# å¯åŠ¨ç‹¬ç«‹ Web æœåŠ¡ï¼ˆä¸å¯åŠ¨åŒæ­¥å¼•æ“ï¼‰
sersync-web -p 8000 -c /etc/sersync.xml

# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
sersync-web --reload --no-auth

# æŒ‡å®šç«¯å£å’Œé…ç½®æ–‡ä»¶
sersync-web -p 9000 -c /etc/sersync.xml
```

---

## ğŸ“¢ é€šçŸ¥ç³»ç»Ÿ

### æ”¯æŒçš„é€šçŸ¥æœåŠ¡

é€šè¿‡ Apprise é›†æˆï¼Œæ”¯æŒ 100+ é€šçŸ¥æœåŠ¡ï¼š

- **å³æ—¶é€šè®¯** - ä¼ä¸šå¾®ä¿¡ã€é’‰é’‰ã€Slackã€Discordã€Telegram
- **é‚®ä»¶** - SMTPã€Gmailã€Outlook
- **çŸ­ä¿¡** - Twilioã€é˜¿é‡Œäº‘ã€è…¾è®¯äº‘
- **æ¨é€** - Pushbulletã€Pushoverã€Gotify
- **Webhook** - è‡ªå®šä¹‰ HTTP Webhook
- æ›´å¤šæœåŠ¡...

### é…ç½®ç¤ºä¾‹

**Apprise é…ç½®æ–‡ä»¶** (`/etc/sersync/apprise.yml`)

```yaml
# ä¼ä¸šå¾®ä¿¡ç¾¤æœºå™¨äºº
urls:
  - wxwork://ä¼ä¸šID/åº”ç”¨AgentId/åº”ç”¨Secret

# Slack
  - slack://TokenA/TokenB/TokenC

# é‚®ä»¶
  - mailto://user:password@gmail.com

# å¤šä¸ªæœåŠ¡
  - wxwork://...
  - slack://...
  - mailto://...
```

### é€šçŸ¥è§„åˆ™

æ”¯æŒ 3 ç§é€šçŸ¥è§„åˆ™ï¼š

1. **ç«‹å³é€šçŸ¥** (`immediate`) - äº‹ä»¶å‘ç”Ÿç«‹å³å‘é€
2. **æ‰¹é‡é€šçŸ¥** (`batch`) - ç´¯ç§¯åˆ°ä¸€å®šæ•°é‡æˆ–æ—¶é—´åæ‰¹é‡å‘é€
3. **å®šæ—¶é€šçŸ¥** (`schedule`) - æŒ‰ cron è¡¨è¾¾å¼å®šæ—¶å‘é€

---

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
pytest tests/test_core.py -v
pytest tests/test_notification.py -v
pytest tests/test_web.py -v
pytest tests/test_bidirectional.py -v

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
pytest --cov=sersync --cov-report=html

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
open htmlcov/index.html
```

### æµ‹è¯•è¦†ç›–èŒƒå›´

- âœ… æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•ï¼ˆæ–‡ä»¶ç›‘æ§ã€äº‹ä»¶é˜Ÿåˆ—ã€åŒæ­¥å¼•æ“ï¼‰
- âœ… é€šçŸ¥ç³»ç»Ÿæµ‹è¯•ï¼ˆApprise é›†æˆã€è§„åˆ™å¼•æ“ï¼‰
- âœ… Web ç³»ç»Ÿæµ‹è¯•ï¼ˆAPI ç«¯ç‚¹ã€WebSocketã€è®¤è¯ï¼‰
- âœ… åŒå‘åŒæ­¥æµ‹è¯•ï¼ˆå†²çªæ£€æµ‹ã€å†²çªè§£å†³ã€Unison é›†æˆï¼‰

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

| æ¨¡å— | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•° | æµ‹è¯•ç”¨ä¾‹ |
|------|-------|---------|---------|
| æ ¸å¿ƒå¼•æ“ | 6 | 2,200+ | 15+ |
| é…ç½®ç³»ç»Ÿ | 2 | 800+ | 5+ |
| é€šçŸ¥ç³»ç»Ÿ | 2 | 740+ | 10+ |
| Web ç•Œé¢ | 9 | 2,000+ | 23+ |
| åŒå‘åŒæ­¥ | 5 | 2,870+ | 30+ |
| å·¥å…·æ¨¡å— | 2 | 200+ | - |
| æµ‹è¯• | 5 | 1,500+ | - |
| **æ€»è®¡** | **42** | **11,710+** | **83+** |

---

## ğŸ†š ä¸åŸå§‹ sersync å¯¹æ¯”

| åŠŸèƒ½ | åŸå§‹ Sersync (C++) | Sersync Python |
|------|-------------------|----------------|
| åŸºæœ¬å•å‘åŒæ­¥ | âœ… | âœ… |
| inotify ç›‘æ§ | âœ… | âœ… |
| Rsync é›†æˆ | âœ… | âœ… |
| äº‹ä»¶è¿‡æ»¤ | âœ… | âœ… å¢å¼º |
| é…ç½®æ–‡ä»¶å…¼å®¹ | âœ… | âœ… 100% å…¼å®¹ |
| è·¨å¹³å°æ”¯æŒ | âŒ Linux only | âœ… Linux/macOS/Windows |
| åŒå‘åŒæ­¥ | âŒ | âœ… **æ–°å¢** |
| å†²çªæ£€æµ‹/è§£å†³ | âŒ | âœ… **æ–°å¢** |
| é€šçŸ¥ç³»ç»Ÿ | âŒ | âœ… **æ–°å¢** |
| Web ç®¡ç†ç•Œé¢ | âŒ | âœ… **æ–°å¢** |
| REST API | âŒ | âœ… **æ–°å¢** |
| WebSocket æ¨é€ | âŒ | âœ… **æ–°å¢** |
| æ•°æ®æŒä¹…åŒ– | âŒ | âœ… **æ–°å¢** |
| Python ç”Ÿæ€ | âŒ | âœ… æ˜“äºæ‰©å±• |

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/yourusername/sersync-python.git
cd sersync-python

# å®‰è£…å¼€å‘ä¾èµ–
poetry install --with dev

# è¿è¡Œæµ‹è¯•
pytest

# ä»£ç æ ¼å¼åŒ–
black sersync/
isort sersync/

# ç±»å‹æ£€æŸ¥
mypy sersync/
```

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## ğŸ™ è‡´è°¢

- åŸå§‹ [sersync](https://code.google.com/archive/p/sersync/) é¡¹ç›®
- [watchdog](https://github.com/gorakhargosh/watchdog) - æ–‡ä»¶ç›‘æ§
- [Apprise](https://github.com/caronc/apprise) - é€šçŸ¥ç³»ç»Ÿ
- [FastAPI](https://fastapi.tiangolo.com/) - Web æ¡†æ¶
- [Unison](https://www.cis.upenn.edu/~bcpierce/unison/) - åŒå‘åŒæ­¥

---

## ğŸ“ è”ç³»æ–¹å¼

- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/yourusername/sersync-python/issues)
- **åŠŸèƒ½å»ºè®®**: [GitHub Discussions](https://github.com/yourusername/sersync-python/discussions)

---

<p align="center">
  <b>â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ª Starï¼</b>
</p>

<p align="center">
  Made with â¤ï¸ by Sersync Python Team
</p>
